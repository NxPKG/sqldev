
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="SQLDev, SQL databases in Python, designed for simplicity, compatibility, and robustness.">
      
      
      
        <link rel="canonical" href="https://sqldev.khulnasoft.com/tutorial/insert/">
      
      
        <link rel="prev" href="../create-db-and-table/">
      
      
        <link rel="next" href="../automatic-id-none-refresh/">
      
      
      <link rel="icon" href="../../img/favicon.png">
      <meta name="generator" content="mkdocs-1.6.0, mkdocs-material-9.5.27">
    
    
      
        <title>Create Rows - Use the Session - INSERT - SQLDev</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.6543a935.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../css/termynal.css">
    
      <link rel="stylesheet" href="../../css/custom.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function n(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],n("js",new Date),n("config","G-J8HVTT936W"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){this.value&&n("event","search",{search_term:this.value})}),document$.subscribe(function(){var a=document.forms.feedback;if(void 0!==a)for(var e of a.querySelectorAll("[type=submit]"))e.addEventListener("click",function(e){e.preventDefault();var t=document.location.pathname,e=this.getAttribute("data-md-value");n("event","feedback",{page:t,data:e}),a.firstElementChild.disabled=!0;e=a.querySelector(".md-feedback__note [data-md-value='"+e+"']");e&&(e.hidden=!1)}),a.hidden=!1}),location$.subscribe(function(e){n("config","G-J8HVTT936W",{page_path:e.pathname})})});var e=document.createElement("script");e.async=!0,e.src="https://www.googletagmanager.com/gtag/js?id=G-J8HVTT936W",document.getElementById("__analytics").insertAdjacentElement("afterEnd",e)}</script>
  
    <script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
  

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="deep-purple" data-md-color-accent="amber">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#create-rows-use-the-session-insert" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="SQLDev" class="md-header__button md-logo" aria-label="SQLDev" data-md-component="logo">
      
  <img src="../../img/icon-white.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            SQLDev
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Create Rows - Use the Session - INSERT
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="deep-purple" data-md-color-accent="amber"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2a7 7 0 0 0-7 7c0 2.38 1.19 4.47 3 5.74V17a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1v-2.26c1.81-1.27 3-3.36 3-5.74a7 7 0 0 0-7-7M9 21a1 1 0 0 0 1 1h4a1 1 0 0 0 1-1v-1H9v1Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="deep-purple" data-md-color-accent="amber"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2a7 7 0 0 1 7 7c0 2.38-1.19 4.47-3 5.74V17a1 1 0 0 1-1 1H9a1 1 0 0 1-1-1v-2.26C6.19 13.47 5 11.38 5 9a7 7 0 0 1 7-7M9 21v-1h6v1a1 1 0 0 1-1 1h-4a1 1 0 0 1-1-1m3-17a5 5 0 0 0-5 5c0 2.05 1.23 3.81 3 4.58V16h4v-2.42c1.77-.77 3-2.53 3-4.58a5 5 0 0 0-5-5Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/khulnasoft/sqldev" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 480 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"/></svg>
  </div>
  <div class="md-source__repository">
    khulnasoft/sqldev
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="SQLDev" class="md-nav__button md-logo" aria-label="SQLDev" data-md-component="logo">
      
  <img src="../../img/icon-white.svg" alt="logo">

    </a>
    SQLDev
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/khulnasoft/sqldev" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 480 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"/></svg>
  </div>
  <div class="md-source__repository">
    khulnasoft/sqldev
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SQLDev
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../features/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Features
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../databases/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Intro to Databases
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../db-to-code/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Database to Code (ORMs)
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Tutorial - User Guide
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5" id="__nav_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Tutorial - User Guide
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../create-db-and-table-with-db-browser/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Create a Table with SQL
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../create-db-and-table/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Create a Table with SQLDev - Use the Engine
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Create Rows - Use the Session - INSERT
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Create Rows - Use the Session - INSERT
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#create-table-and-database" class="md-nav__link">
    <span class="md-ellipsis">
      Create Table and Database
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#create-data-with-sql" class="md-nav__link">
    <span class="md-ellipsis">
      Create Data with SQL
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Create Data with SQL">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#try-it-in-db-explorer-for-sqlite" class="md-nav__link">
    <span class="md-ellipsis">
      Try it in DB Explorer for SQLite
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#data-in-a-database-and-data-in-code" class="md-nav__link">
    <span class="md-ellipsis">
      Data in a Database and Data in Code
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#create-data-with-python-and-sqldev" class="md-nav__link">
    <span class="md-ellipsis">
      Create Data with Python and SQLDev
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#create-a-model-instance" class="md-nav__link">
    <span class="md-ellipsis">
      Create a Model Instance
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#create-a-session" class="md-nav__link">
    <span class="md-ellipsis">
      Create a Session
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#add-model-instances-to-the-session" class="md-nav__link">
    <span class="md-ellipsis">
      Add Model Instances to the Session
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#commit-the-session-changes" class="md-nav__link">
    <span class="md-ellipsis">
      Commit the Session Changes
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#create-heroes-as-a-script" class="md-nav__link">
    <span class="md-ellipsis">
      Create Heroes as a Script
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#run-the-script" class="md-nav__link">
    <span class="md-ellipsis">
      Run the Script
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#close-the-session" class="md-nav__link">
    <span class="md-ellipsis">
      Close the Session
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#a-session-in-a-with-block" class="md-nav__link">
    <span class="md-ellipsis">
      A Session in a with Block
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#review-all-the-code" class="md-nav__link">
    <span class="md-ellipsis">
      Review All the Code
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#whats-next" class="md-nav__link">
    <span class="md-ellipsis">
      What's Next
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../automatic-id-none-refresh/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Automatic IDs, None Defaults, and Refreshing Data
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../select/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Read Data - SELECT
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../where/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Filter Data - WHERE
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../indexes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Indexes - Optimize Queries
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../one/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Read One Row
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../limit-and-offset/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Read a Range of Data - LIMIT and OFFSET
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../update/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Update Data - UPDATE
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../delete/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Delete Data - DELETE
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_13" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../connect/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Connect Tables - JOIN
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_13" id="__nav_5_13_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_13_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_13">
            <span class="md-nav__icon md-icon"></span>
            Connect Tables - JOIN
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../connect/create-connected-tables/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Create Connected Tables
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../connect/create-connected-rows/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Create and Connect Rows
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../connect/read-connected-data/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Read Connected Data
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../connect/update-data-connections/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Update Data Connections
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../connect/remove-data-connections/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Remove Data Connections
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_14" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../relationship-attributes/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Relationship Attributes
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_14" id="__nav_5_14_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_14_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_14">
            <span class="md-nav__icon md-icon"></span>
            Relationship Attributes
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../relationship-attributes/define-relationships-attributes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Define Relationships Attributes
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../relationship-attributes/create-and-update-relationships/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Create and Update Relationships
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../relationship-attributes/read-relationships/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Read Relationships
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../relationship-attributes/remove-relationships/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Remove Relationships
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../relationship-attributes/back-populates/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Relationship back_populates
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../relationship-attributes/type-annotation-strings/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Type annotation strings
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_15" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../many-to-many/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Many to Many
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_15" id="__nav_5_15_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_15_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_15">
            <span class="md-nav__icon md-icon"></span>
            Many to Many
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../many-to-many/create-models-with-link/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Create Models with a Many-to-Many Link
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../many-to-many/create-data/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Create Data with Many-to-Many Relationships
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../many-to-many/update-remove-relationships/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Update and Remove Many-to-Many Relationships
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../many-to-many/link-with-extra-fields/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Link Model with Extra Fields
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../code-structure/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Code Structure and Multiple Files
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_17" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../readyapi/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    ReadyAPI and Pydantic
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_17" id="__nav_5_17_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_17_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_17">
            <span class="md-nav__icon md-icon"></span>
            ReadyAPI and Pydantic
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../readyapi/simple-hero-api/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Simple Hero API with ReadyAPI
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../readyapi/response-model/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ReadyAPI Response Model with SQLDev
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../readyapi/multiple-models/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Multiple Models with ReadyAPI
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../readyapi/read-one/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Read One Model with ReadyAPI
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../readyapi/limit-and-offset/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Read Heroes with Limit and Offset with ReadyAPI
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../readyapi/update/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Update Data with ReadyAPI
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../readyapi/update-extra-data/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Update with Extra Data (Hashed Passwords) with ReadyAPI
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../readyapi/delete/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Delete Data with ReadyAPI
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../readyapi/session-with-dependency/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Session with ReadyAPI Dependency
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../readyapi/teams/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ReadyAPI Path Operations for Teams - Other Models
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../readyapi/relationships/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Models with Relationships in ReadyAPI
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../readyapi/tests/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Test Applications with ReadyAPI and SQLDev
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../advanced/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Advanced User Guide
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6" id="__nav_6_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Advanced User Guide
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../advanced/decimal/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Decimal Numbers
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../alternatives/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Alternatives, Inspiration and Comparisons
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../help/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Help SQLDev - Get Help
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../contributing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Contributing
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../release-notes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Release Notes
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#create-table-and-database" class="md-nav__link">
    <span class="md-ellipsis">
      Create Table and Database
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#create-data-with-sql" class="md-nav__link">
    <span class="md-ellipsis">
      Create Data with SQL
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Create Data with SQL">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#try-it-in-db-explorer-for-sqlite" class="md-nav__link">
    <span class="md-ellipsis">
      Try it in DB Explorer for SQLite
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#data-in-a-database-and-data-in-code" class="md-nav__link">
    <span class="md-ellipsis">
      Data in a Database and Data in Code
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#create-data-with-python-and-sqldev" class="md-nav__link">
    <span class="md-ellipsis">
      Create Data with Python and SQLDev
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#create-a-model-instance" class="md-nav__link">
    <span class="md-ellipsis">
      Create a Model Instance
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#create-a-session" class="md-nav__link">
    <span class="md-ellipsis">
      Create a Session
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#add-model-instances-to-the-session" class="md-nav__link">
    <span class="md-ellipsis">
      Add Model Instances to the Session
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#commit-the-session-changes" class="md-nav__link">
    <span class="md-ellipsis">
      Commit the Session Changes
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#create-heroes-as-a-script" class="md-nav__link">
    <span class="md-ellipsis">
      Create Heroes as a Script
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#run-the-script" class="md-nav__link">
    <span class="md-ellipsis">
      Run the Script
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#close-the-session" class="md-nav__link">
    <span class="md-ellipsis">
      Close the Session
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#a-session-in-a-with-block" class="md-nav__link">
    <span class="md-ellipsis">
      A Session in a with Block
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#review-all-the-code" class="md-nav__link">
    <span class="md-ellipsis">
      Review All the Code
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#whats-next" class="md-nav__link">
    <span class="md-ellipsis">
      What's Next
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="create-rows-use-the-session-insert">Create Rows - Use the Session - INSERT<a class="headerlink" href="#create-rows-use-the-session-insert" title="Permanent link">&para;</a></h1>
<p>Now that we have a database and a table, we can start adding data.</p>
<p>Here's a reminder of how the table would look like, this is the data we want to add:</p>
<table>
<tr>
<th>id</th><th>name</th><th>secret_name</th><th>age</th>
</tr>
<tr>
<td>1</td><td>Deadpond</td><td>Nx Pkg</td><td>null</td>
</tr>
<tr>
<td>2</td><td>Spider-Boy</td><td>Pedro Parqueador</td><td>null</td>
</tr>
<tr>
<td>3</td><td>Rusty-Man</td><td>Tommy Sharp</td><td>48</td>
</tr>
</table>

<h2 id="create-table-and-database">Create Table and Database<a class="headerlink" href="#create-table-and-database" title="Permanent link">&para;</a></h2>
<p>We will continue from where we left of in the last chapter.</p>
<p>This is the code we had to create the database and table, nothing new here:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="1:2"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio" /><input id="__tabbed_1_2" name="__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="__tabbed_1_1">Python 3.10+</label><label for="__tabbed_1_2">Python 3.7+</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="annotate highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">sqldev</span> <span class="kn">import</span> <span class="n">Field</span><span class="p">,</span> <span class="n">SQLDev</span><span class="p">,</span> <span class="n">create_engine</span>  <span class="c1"># (2)!</span>


<span class="k">class</span> <span class="nc">Hero</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>  <span class="c1"># (3)!</span>
    <span class="nb">id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># (4)!</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>  <span class="c1"># (5)!</span>
    <span class="n">secret_name</span><span class="p">:</span> <span class="nb">str</span>  <span class="c1"># (6)!</span>
    <span class="n">age</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># (7)!</span>


<span class="n">sqlite_file_name</span> <span class="o">=</span> <span class="s2">&quot;database.db&quot;</span>  <span class="c1"># (8)!</span>
<span class="n">sqlite_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;sqlite:///</span><span class="si">{</span><span class="n">sqlite_file_name</span><span class="si">}</span><span class="s2">&quot;</span>  <span class="c1"># (9)!</span>

<span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="n">sqlite_url</span><span class="p">,</span> <span class="n">echo</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># (10)!</span>


<span class="k">def</span> <span class="nf">create_db_and_tables</span><span class="p">():</span>  <span class="c1"># (11)!</span>
    <span class="n">SQLDev</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">create_all</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span>  <span class="c1"># (12)!</span>

<span class="hll"><span class="c1"># More code here later 👈</span>
</span>
<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>  <span class="c1"># (13)!</span>
    <span class="n">create_db_and_tables</span><span class="p">()</span>  <span class="c1"># (14)!</span>
</code></pre></div>
<ol>
<li>Import <code>Optional</code> from <code>typing</code> to declare fields that could be <code>None</code>.</li>
<li>Import the things we will need from <code>sqldev</code>: <code>Field</code>, <code>SQLDev</code>, <code>create_engine</code>.</li>
<li>
<p>Create the <code>Hero</code> model class, representing the <code>hero</code> table in the database.</p>
<p>And also mark this class as a <strong>table model</strong> with <code>table=True</code>.</p>
</li>
<li>
<p>Create the <code>id</code> field:</p>
<p>It could be <code>None</code> until the database assigns a value to it, so we annotate it with <code>Optional</code>.</p>
<p>It is a <strong>primary key</strong>, so we use <code>Field()</code> and the argument <code>primary_key=True</code>.</p>
</li>
<li>
<p>Create the <code>name</code> field.</p>
<p>It is required, so there's no default value, and it's not <code>Optional</code>.</p>
</li>
<li>
<p>Create the <code>secret_name</code> field.</p>
<p>Also required.</p>
</li>
<li>
<p>Create the <code>age</code> field.</p>
<p>It is not required, the default value is <code>None</code>.</p>
<p>In the database, the default value will be <code>NULL</code>, the SQL equivalent of <code>None</code>.</p>
<p>As this field could be <code>None</code> (and <code>NULL</code> in the database), we annotate it with <code>Optional</code>.</p>
</li>
<li>
<p>Write the name of the database file.</p>
</li>
<li>Use the name of the database file to create the database URL.</li>
<li>
<p>Create the engine using the URL.</p>
<p>This doesn't create the database yet, no file or table is created at this point, only the <strong>engine</strong> object that will handle the connections with this specific database, and with specific support for SQLite (based on the URL).</p>
</li>
<li>
<p>Put the code that creates side effects in a function.</p>
<p>In this case, only one line that creates the database file with the table.</p>
</li>
<li>
<p>Create all the tables that were automatically registered in <code>SQLDev.metadata</code>.</p>
</li>
<li>
<p>Add a main block, or "Top-level script environment".</p>
<p>And put some logic to be executed when this is called directly with Python, as in:</p>
<div class="termy">
<div class="highlight"><pre><span></span><code><span class="gp">$ </span>python<span class="w"> </span>app.py

<span class="go">// Execute all the stuff and show the output</span>
</code></pre></div>
</div>
<p>...but that is not executed when importing something from this module, like:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">app</span> <span class="kn">import</span> <span class="n">Hero</span>
</code></pre></div>
</li>
<li>
<p>In this main block, call the function that creates the database file and the table.</p>
<p>This way when we call it with:</p>
<div class="termy">
<div class="highlight"><pre><span></span><code><span class="gp">$ </span>python<span class="w"> </span>app.py

<span class="go">// Doing stuff ✨</span>
</code></pre></div>
</div>
<p>...it will create the database file and the table.</p>
</li>
</ol>
</div>
<div class="tabbed-block">
<div class="annotate highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Optional</span>  <span class="c1"># (1)!</span>

<span class="kn">from</span> <span class="nn">sqldev</span> <span class="kn">import</span> <span class="n">Field</span><span class="p">,</span> <span class="n">SQLDev</span><span class="p">,</span> <span class="n">create_engine</span>  <span class="c1"># (2)!</span>


<span class="k">class</span> <span class="nc">Hero</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>  <span class="c1"># (3)!</span>
    <span class="nb">id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># (4)!</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>  <span class="c1"># (5)!</span>
    <span class="n">secret_name</span><span class="p">:</span> <span class="nb">str</span>  <span class="c1"># (6)!</span>
    <span class="n">age</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># (7)!</span>


<span class="n">sqlite_file_name</span> <span class="o">=</span> <span class="s2">&quot;database.db&quot;</span>  <span class="c1"># (8)!</span>
<span class="n">sqlite_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;sqlite:///</span><span class="si">{</span><span class="n">sqlite_file_name</span><span class="si">}</span><span class="s2">&quot;</span>  <span class="c1"># (9)!</span>

<span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="n">sqlite_url</span><span class="p">,</span> <span class="n">echo</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># (10)!</span>


<span class="k">def</span> <span class="nf">create_db_and_tables</span><span class="p">():</span>  <span class="c1"># (11)!</span>
    <span class="n">SQLDev</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">create_all</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span>  <span class="c1"># (12)!</span>

<span class="hll"><span class="c1"># More code here later 👈</span>
</span>
<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>  <span class="c1"># (13)!</span>
    <span class="n">create_db_and_tables</span><span class="p">()</span>  <span class="c1"># (14)!</span>
</code></pre></div>
<ol>
<li>Import <code>Optional</code> from <code>typing</code> to declare fields that could be <code>None</code>.</li>
<li>Import the things we will need from <code>sqldev</code>: <code>Field</code>, <code>SQLDev</code>, <code>create_engine</code>.</li>
<li>
<p>Create the <code>Hero</code> model class, representing the <code>hero</code> table in the database.</p>
<p>And also mark this class as a <strong>table model</strong> with <code>table=True</code>.</p>
</li>
<li>
<p>Create the <code>id</code> field:</p>
<p>It could be <code>None</code> until the database assigns a value to it, so we annotate it with <code>Optional</code>.</p>
<p>It is a <strong>primary key</strong>, so we use <code>Field()</code> and the argument <code>primary_key=True</code>.</p>
</li>
<li>
<p>Create the <code>name</code> field.</p>
<p>It is required, so there's no default value, and it's not <code>Optional</code>.</p>
</li>
<li>
<p>Create the <code>secret_name</code> field.</p>
<p>Also required.</p>
</li>
<li>
<p>Create the <code>age</code> field.</p>
<p>It is not required, the default value is <code>None</code>.</p>
<p>In the database, the default value will be <code>NULL</code>, the SQL equivalent of <code>None</code>.</p>
<p>As this field could be <code>None</code> (and <code>NULL</code> in the database), we annotate it with <code>Optional</code>.</p>
</li>
<li>
<p>Write the name of the database file.</p>
</li>
<li>Use the name of the database file to create the database URL.</li>
<li>
<p>Create the engine using the URL.</p>
<p>This doesn't create the database yet, no file or table is created at this point, only the <strong>engine</strong> object that will handle the connections with this specific database, and with specific support for SQLite (based on the URL).</p>
</li>
<li>
<p>Put the code that creates side effects in a function.</p>
<p>In this case, only one line that creates the database file with the table.</p>
</li>
<li>
<p>Create all the tables that were automatically registered in <code>SQLDev.metadata</code>.</p>
</li>
<li>
<p>Add a main block, or "Top-level script environment".</p>
<p>And put some logic to be executed when this is called directly with Python, as in:</p>
<div class="termy">
<div class="highlight"><pre><span></span><code><span class="gp">$ </span>python<span class="w"> </span>app.py

<span class="go">// Execute all the stuff and show the output</span>
</code></pre></div>
</div>
<p>...but that is not executed when importing something from this module, like:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">app</span> <span class="kn">import</span> <span class="n">Hero</span>
</code></pre></div>
</li>
<li>
<p>In this main block, call the function that creates the database file and the table.</p>
<p>This way when we call it with:</p>
<div class="termy">
<div class="highlight"><pre><span></span><code><span class="gp">$ </span>python<span class="w"> </span>app.py

<span class="go">// Doing stuff ✨</span>
</code></pre></div>
</div>
<p>...it will create the database file and the table.</p>
</li>
</ol>
</div>
</div>
</div>
<p>Now that we can create the database and the table, we will continue from this point and add more code on the same file to create the data.</p>
<h2 id="create-data-with-sql">Create Data with SQL<a class="headerlink" href="#create-data-with-sql" title="Permanent link">&para;</a></h2>
<p>Before working with Python code, let's see how we can create data with SQL.</p>
<p>Let's say we want to insert the record/row for <code>Deadpond</code> into our database.</p>
<p>We can do this with the following SQL code:</p>
<div class="highlight"><pre><span></span><code><span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="ss">&quot;hero&quot;</span><span class="w"> </span><span class="p">(</span><span class="ss">&quot;name&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;secret_name&quot;</span><span class="p">)</span>
<span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="ss">&quot;Deadpond&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;Nx Pkg&quot;</span><span class="p">);</span>
</code></pre></div>
<p>It means, more or less:</p>
<blockquote>
<p>Hey SQL database 👋, please <code>INSERT</code> something (create a record/row) <code>INTO</code> the table <code>"hero"</code>.</p>
<p>I want you to insert a row with some values in these specific columns:</p>
<ul>
<li><code>"name"</code></li>
<li><code>"secret_name"</code></li>
</ul>
<p>And the values I want you to put in these columns are:</p>
<ul>
<li><code>"Deadpond"</code></li>
<li><code>"Nx Pkg"</code></li>
</ul>
</blockquote>
<h3 id="try-it-in-db-explorer-for-sqlite">Try it in DB Explorer for SQLite<a class="headerlink" href="#try-it-in-db-explorer-for-sqlite" title="Permanent link">&para;</a></h3>
<p>You can try that SQL statement in <strong>DB Explorer for SQLite</strong>.</p>
<p>Make sure to open the same database we already created by clicking <kbd>Open Database</kbd> and selecting the same <code>database.db</code> file.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>If you don't have that <code>database.db</code> file with the table <code>hero</code>, you can re-create it by running the Python program at the top. 👆</p>
</div>
<p>Then go to the <kbd>Execute SQL</kbd> tab and copy the SQL from above.</p>
<p>It would look like this:</p>
<p><img class="shadow" src="/img/tutorial/insert/image01.png"></p>
<p>Click the "Execute all" <kbd>▶</kbd> button.</p>
<p>Then you can go to the <kbd>Browse Data</kbd> tab, and you will see your newly created record/row:</p>
<p><img class="shadow" src="/img/tutorial/insert/image02.png"></p>
<h2 id="data-in-a-database-and-data-in-code">Data in a Database and Data in Code<a class="headerlink" href="#data-in-a-database-and-data-in-code" title="Permanent link">&para;</a></h2>
<p>When working with a database (SQL or any other type) in a programming language, we will always have some data <strong>in memory</strong>, in objects and variables we create in our code, and there will be some data <strong>in the database</strong>.</p>
<p>We are constantly <strong>getting</strong> <em>some</em> of the data from the database and putting it in memory, in variables.</p>
<p>The same way, we are constantly <strong>creating</strong> variables and objects with data in our code, that we then want to save in the database, so we <strong>send</strong> it somehow.</p>
<p>In some cases, we can even create some data in memory and then change it and update it before saving it in the database.</p>
<p>We might even decide with some logic in the code that we no longer want to save the data in the database, and then just remove it. 🔥 And we only handled that data in memory, without sending it back and forth to the database.</p>
<p><strong>SQLDev</strong> does all it can (actually via SQLAlchemy) to make this interaction as simple, intuitive, and familiar or "close to programming" as possible. ✨</p>
<p>But that division of the two places where some data might be at each moment in time (in memory or in the database) is always there. And it's important for you to have it in mind. 🤓</p>
<h2 id="create-data-with-python-and-sqldev">Create Data with Python and <strong>SQLDev</strong><a class="headerlink" href="#create-data-with-python-and-sqldev" title="Permanent link">&para;</a></h2>
<p>Now let's create that same row in Python.</p>
<p>First, remove that file <code>database.db</code> so we can start from a clean slate.</p>
<p>Because we have Python code executing with data in memory, and the database is an independent system (an external SQLite file, or an external database server), we need to perform two steps:</p>
<ul>
<li>create the data in Python, in memory (in a variable)</li>
<li>save/send the data to the database</li>
</ul>
<h2 id="create-a-model-instance">Create a Model Instance<a class="headerlink" href="#create-a-model-instance" title="Permanent link">&para;</a></h2>
<p>Let's start with the first step, create the data in memory.</p>
<p>We already created a class <code>Hero</code> that represents the <code>hero</code> table in the database.</p>
<p>Each instance we create will represent the data in a row in the database.</p>
<p>So, the first step is to simply create an instance of <code>Hero</code>.</p>
<p>We'll create 3 right away, for the 3 heroes:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="2:2"><input checked="checked" id="__tabbed_2_1" name="__tabbed_2" type="radio" /><input id="__tabbed_2_2" name="__tabbed_2" type="radio" /><div class="tabbed-labels"><label for="__tabbed_2_1">Python 3.10+</label><label for="__tabbed_2_2">Python 3.7+</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1"># Code above omitted 👆</span>

<span class="k">def</span> <span class="nf">create_heroes</span><span class="p">():</span>
    <span class="n">hero_1</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Deadpond&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Nx Pkg&quot;</span><span class="p">)</span>
    <span class="n">hero_2</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Spider-Boy&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Pedro Parqueador&quot;</span><span class="p">)</span>
    <span class="n">hero_3</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Rusty-Man&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Tommy Sharp&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">48</span><span class="p">)</span>

<span class="c1"># More code here later 👇</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1"># Code above omitted 👆</span>

<span class="k">def</span> <span class="nf">create_heroes</span><span class="p">():</span>
    <span class="n">hero_1</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Deadpond&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Nx Pkg&quot;</span><span class="p">)</span>
    <span class="n">hero_2</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Spider-Boy&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Pedro Parqueador&quot;</span><span class="p">)</span>
    <span class="n">hero_3</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Rusty-Man&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Tommy Sharp&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">48</span><span class="p">)</span>

<span class="c1"># More code here later 👇</span>
</code></pre></div>
</div>
</div>
</div>
<details>
<summary>👀 Full file preview</summary>
<div class="tabbed-set tabbed-alternate" data-tabs="3:2"><input checked="checked" id="__tabbed_3_1" name="__tabbed_3" type="radio" /><input id="__tabbed_3_2" name="__tabbed_3" type="radio" /><div class="tabbed-labels"><label for="__tabbed_3_1">Python 3.10+</label><label for="__tabbed_3_2">Python 3.7+</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">sqldev</span> <span class="kn">import</span> <span class="n">Field</span><span class="p">,</span> <span class="n">Session</span><span class="p">,</span> <span class="n">SQLDev</span><span class="p">,</span> <span class="n">create_engine</span>


<span class="k">class</span> <span class="nc">Hero</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="nb">id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">secret_name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">age</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>


<span class="n">sqlite_file_name</span> <span class="o">=</span> <span class="s2">&quot;database.db&quot;</span>
<span class="n">sqlite_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;sqlite:///</span><span class="si">{</span><span class="n">sqlite_file_name</span><span class="si">}</span><span class="s2">&quot;</span>

<span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="n">sqlite_url</span><span class="p">,</span> <span class="n">echo</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">create_db_and_tables</span><span class="p">():</span>
    <span class="n">SQLDev</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">create_all</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">create_heroes</span><span class="p">():</span>
    <span class="n">hero_1</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Deadpond&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Nx Pkg&quot;</span><span class="p">)</span>
    <span class="n">hero_2</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Spider-Boy&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Pedro Parqueador&quot;</span><span class="p">)</span>
    <span class="n">hero_3</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Rusty-Man&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Tommy Sharp&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">48</span><span class="p">)</span>

    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_1</span><span class="p">)</span>
        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_2</span><span class="p">)</span>
        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_3</span><span class="p">)</span>

        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">create_db_and_tables</span><span class="p">()</span>
    <span class="n">create_heroes</span><span class="p">()</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Optional</span>

<span class="kn">from</span> <span class="nn">sqldev</span> <span class="kn">import</span> <span class="n">Field</span><span class="p">,</span> <span class="n">Session</span><span class="p">,</span> <span class="n">SQLDev</span><span class="p">,</span> <span class="n">create_engine</span>


<span class="k">class</span> <span class="nc">Hero</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="nb">id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">secret_name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">age</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>


<span class="n">sqlite_file_name</span> <span class="o">=</span> <span class="s2">&quot;database.db&quot;</span>
<span class="n">sqlite_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;sqlite:///</span><span class="si">{</span><span class="n">sqlite_file_name</span><span class="si">}</span><span class="s2">&quot;</span>

<span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="n">sqlite_url</span><span class="p">,</span> <span class="n">echo</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">create_db_and_tables</span><span class="p">():</span>
    <span class="n">SQLDev</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">create_all</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">create_heroes</span><span class="p">():</span>
    <span class="n">hero_1</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Deadpond&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Nx Pkg&quot;</span><span class="p">)</span>
    <span class="n">hero_2</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Spider-Boy&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Pedro Parqueador&quot;</span><span class="p">)</span>
    <span class="n">hero_3</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Rusty-Man&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Tommy Sharp&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">48</span><span class="p">)</span>

    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_1</span><span class="p">)</span>
        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_2</span><span class="p">)</span>
        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_3</span><span class="p">)</span>

        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">create_db_and_tables</span><span class="p">()</span>
    <span class="n">create_heroes</span><span class="p">()</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</code></pre></div>
</div>
</div>
</div>
</details>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>The code above in this file (the omitted code) is just the same code that you see at the top of this chapter.</p>
<p>The same code we used before to create the <code>Hero</code> model.</p>
</div>
<p>We are putting that in a function <code>create_heroes()</code>, to call it later once we finish it.</p>
<p>If you are trying the code interactively, you could also write that directly.</p>
<h2 id="create-a-session">Create a <strong>Session</strong><a class="headerlink" href="#create-a-session" title="Permanent link">&para;</a></h2>
<p>Up to now, we have only used the <strong>engine</strong> to interact with the database.</p>
<p>The <strong>engine</strong> is that single object that we share with all the code, and that is in charge of communicating with the database, handling the connections (when using a server database like PostgreSQL or MySQL), etc.</p>
<p>But when working with <strong>SQLDev</strong> you will mostly use another tool that sits on top, the <strong>Session</strong>.</p>
<p>In contrast to the <strong>engine</strong> that is one for the whole application, we create a new <strong>session</strong> for each group of operations with the database that belong together.</p>
<p>In fact, the <strong>session</strong> needs and uses an <strong>engine</strong>.</p>
<p>For example, if we have a web application, we would normally have a single <strong>session</strong> per request.</p>
<p>We would re-use the same <strong>engine</strong> in all the code, everywhere in the application (shared by all the requests). But for each request, we would create and use a new <strong>session</strong>. And once the request is done, we would close the session.</p>
<p>The first step is to import the <code>Session</code> class:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="4:2"><input checked="checked" id="__tabbed_4_1" name="__tabbed_4" type="radio" /><input id="__tabbed_4_2" name="__tabbed_4" type="radio" /><div class="tabbed-labels"><label for="__tabbed_4_1">Python 3.10+</label><label for="__tabbed_4_2">Python 3.7+</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="hll"><span class="kn">from</span> <span class="nn">sqldev</span> <span class="kn">import</span> <span class="n">Field</span><span class="p">,</span> <span class="n">Session</span><span class="p">,</span> <span class="n">SQLDev</span><span class="p">,</span> <span class="n">create_engine</span>
</span>
<span class="c1"># Code below omitted 👇</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Optional</span>

<span class="hll"><span class="kn">from</span> <span class="nn">sqldev</span> <span class="kn">import</span> <span class="n">Field</span><span class="p">,</span> <span class="n">Session</span><span class="p">,</span> <span class="n">SQLDev</span><span class="p">,</span> <span class="n">create_engine</span>
</span>
<span class="c1"># Code below omitted 👇</span>
</code></pre></div>
</div>
</div>
</div>
<details>
<summary>👀 Full file preview</summary>
<div class="tabbed-set tabbed-alternate" data-tabs="5:2"><input checked="checked" id="__tabbed_5_1" name="__tabbed_5" type="radio" /><input id="__tabbed_5_2" name="__tabbed_5" type="radio" /><div class="tabbed-labels"><label for="__tabbed_5_1">Python 3.10+</label><label for="__tabbed_5_2">Python 3.7+</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">sqldev</span> <span class="kn">import</span> <span class="n">Field</span><span class="p">,</span> <span class="n">Session</span><span class="p">,</span> <span class="n">SQLDev</span><span class="p">,</span> <span class="n">create_engine</span>


<span class="k">class</span> <span class="nc">Hero</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="nb">id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">secret_name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">age</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>


<span class="n">sqlite_file_name</span> <span class="o">=</span> <span class="s2">&quot;database.db&quot;</span>
<span class="n">sqlite_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;sqlite:///</span><span class="si">{</span><span class="n">sqlite_file_name</span><span class="si">}</span><span class="s2">&quot;</span>

<span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="n">sqlite_url</span><span class="p">,</span> <span class="n">echo</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">create_db_and_tables</span><span class="p">():</span>
    <span class="n">SQLDev</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">create_all</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">create_heroes</span><span class="p">():</span>
    <span class="n">hero_1</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Deadpond&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Nx Pkg&quot;</span><span class="p">)</span>
    <span class="n">hero_2</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Spider-Boy&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Pedro Parqueador&quot;</span><span class="p">)</span>
    <span class="n">hero_3</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Rusty-Man&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Tommy Sharp&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">48</span><span class="p">)</span>

    <span class="n">session</span> <span class="o">=</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span>

    <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_1</span><span class="p">)</span>
    <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_2</span><span class="p">)</span>
    <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_3</span><span class="p">)</span>

    <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>

    <span class="n">session</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">create_db_and_tables</span><span class="p">()</span>
    <span class="n">create_heroes</span><span class="p">()</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Optional</span>

<span class="kn">from</span> <span class="nn">sqldev</span> <span class="kn">import</span> <span class="n">Field</span><span class="p">,</span> <span class="n">Session</span><span class="p">,</span> <span class="n">SQLDev</span><span class="p">,</span> <span class="n">create_engine</span>


<span class="k">class</span> <span class="nc">Hero</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="nb">id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">secret_name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">age</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>


<span class="n">sqlite_file_name</span> <span class="o">=</span> <span class="s2">&quot;database.db&quot;</span>
<span class="n">sqlite_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;sqlite:///</span><span class="si">{</span><span class="n">sqlite_file_name</span><span class="si">}</span><span class="s2">&quot;</span>

<span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="n">sqlite_url</span><span class="p">,</span> <span class="n">echo</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">create_db_and_tables</span><span class="p">():</span>
    <span class="n">SQLDev</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">create_all</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">create_heroes</span><span class="p">():</span>
    <span class="n">hero_1</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Deadpond&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Nx Pkg&quot;</span><span class="p">)</span>
    <span class="n">hero_2</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Spider-Boy&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Pedro Parqueador&quot;</span><span class="p">)</span>
    <span class="n">hero_3</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Rusty-Man&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Tommy Sharp&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">48</span><span class="p">)</span>

    <span class="n">session</span> <span class="o">=</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span>

    <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_1</span><span class="p">)</span>
    <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_2</span><span class="p">)</span>
    <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_3</span><span class="p">)</span>

    <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>

    <span class="n">session</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">create_db_and_tables</span><span class="p">()</span>
    <span class="n">create_heroes</span><span class="p">()</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</code></pre></div>
</div>
</div>
</div>
</details>
<p>Then we can create a new session:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="6:2"><input checked="checked" id="__tabbed_6_1" name="__tabbed_6" type="radio" /><input id="__tabbed_6_2" name="__tabbed_6" type="radio" /><div class="tabbed-labels"><label for="__tabbed_6_1">Python 3.10+</label><label for="__tabbed_6_2">Python 3.7+</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1"># Code above omitted 👆</span>

<span class="k">def</span> <span class="nf">create_heroes</span><span class="p">():</span>
    <span class="n">hero_1</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Deadpond&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Nx Pkg&quot;</span><span class="p">)</span>
    <span class="n">hero_2</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Spider-Boy&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Pedro Parqueador&quot;</span><span class="p">)</span>
    <span class="n">hero_3</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Rusty-Man&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Tommy Sharp&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">48</span><span class="p">)</span>

<span class="hll">    <span class="n">session</span> <span class="o">=</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span>
</span>
<span class="c1"># More code here later 👇</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1"># Code above omitted 👆</span>

<span class="k">def</span> <span class="nf">create_heroes</span><span class="p">():</span>
    <span class="n">hero_1</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Deadpond&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Nx Pkg&quot;</span><span class="p">)</span>
    <span class="n">hero_2</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Spider-Boy&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Pedro Parqueador&quot;</span><span class="p">)</span>
    <span class="n">hero_3</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Rusty-Man&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Tommy Sharp&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">48</span><span class="p">)</span>

<span class="hll">    <span class="n">session</span> <span class="o">=</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span>
</span>
<span class="c1"># More code here later 👇</span>
</code></pre></div>
</div>
</div>
</div>
<details>
<summary>👀 Full file preview</summary>
<div class="tabbed-set tabbed-alternate" data-tabs="7:2"><input checked="checked" id="__tabbed_7_1" name="__tabbed_7" type="radio" /><input id="__tabbed_7_2" name="__tabbed_7" type="radio" /><div class="tabbed-labels"><label for="__tabbed_7_1">Python 3.10+</label><label for="__tabbed_7_2">Python 3.7+</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">sqldev</span> <span class="kn">import</span> <span class="n">Field</span><span class="p">,</span> <span class="n">Session</span><span class="p">,</span> <span class="n">SQLDev</span><span class="p">,</span> <span class="n">create_engine</span>


<span class="k">class</span> <span class="nc">Hero</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="nb">id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">secret_name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">age</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>


<span class="n">sqlite_file_name</span> <span class="o">=</span> <span class="s2">&quot;database.db&quot;</span>
<span class="n">sqlite_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;sqlite:///</span><span class="si">{</span><span class="n">sqlite_file_name</span><span class="si">}</span><span class="s2">&quot;</span>

<span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="n">sqlite_url</span><span class="p">,</span> <span class="n">echo</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">create_db_and_tables</span><span class="p">():</span>
    <span class="n">SQLDev</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">create_all</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">create_heroes</span><span class="p">():</span>
    <span class="n">hero_1</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Deadpond&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Nx Pkg&quot;</span><span class="p">)</span>
    <span class="n">hero_2</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Spider-Boy&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Pedro Parqueador&quot;</span><span class="p">)</span>
    <span class="n">hero_3</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Rusty-Man&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Tommy Sharp&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">48</span><span class="p">)</span>

    <span class="n">session</span> <span class="o">=</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span>

    <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_1</span><span class="p">)</span>
    <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_2</span><span class="p">)</span>
    <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_3</span><span class="p">)</span>

    <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>

    <span class="n">session</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">create_db_and_tables</span><span class="p">()</span>
    <span class="n">create_heroes</span><span class="p">()</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Optional</span>

<span class="kn">from</span> <span class="nn">sqldev</span> <span class="kn">import</span> <span class="n">Field</span><span class="p">,</span> <span class="n">Session</span><span class="p">,</span> <span class="n">SQLDev</span><span class="p">,</span> <span class="n">create_engine</span>


<span class="k">class</span> <span class="nc">Hero</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="nb">id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">secret_name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">age</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>


<span class="n">sqlite_file_name</span> <span class="o">=</span> <span class="s2">&quot;database.db&quot;</span>
<span class="n">sqlite_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;sqlite:///</span><span class="si">{</span><span class="n">sqlite_file_name</span><span class="si">}</span><span class="s2">&quot;</span>

<span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="n">sqlite_url</span><span class="p">,</span> <span class="n">echo</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">create_db_and_tables</span><span class="p">():</span>
    <span class="n">SQLDev</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">create_all</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">create_heroes</span><span class="p">():</span>
    <span class="n">hero_1</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Deadpond&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Nx Pkg&quot;</span><span class="p">)</span>
    <span class="n">hero_2</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Spider-Boy&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Pedro Parqueador&quot;</span><span class="p">)</span>
    <span class="n">hero_3</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Rusty-Man&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Tommy Sharp&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">48</span><span class="p">)</span>

    <span class="n">session</span> <span class="o">=</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span>

    <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_1</span><span class="p">)</span>
    <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_2</span><span class="p">)</span>
    <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_3</span><span class="p">)</span>

    <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>

    <span class="n">session</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">create_db_and_tables</span><span class="p">()</span>
    <span class="n">create_heroes</span><span class="p">()</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</code></pre></div>
</div>
</div>
</div>
</details>
<p>The new <code>Session</code> takes an <code>engine</code> as a parameter. And it will use the <strong>engine</strong> underneath.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>We will see a better way to create a <strong>session</strong> using a <code>with</code> block later.</p>
</div>
<h2 id="add-model-instances-to-the-session">Add Model Instances to the Session<a class="headerlink" href="#add-model-instances-to-the-session" title="Permanent link">&para;</a></h2>
<p>Now that we have some hero model instances (some objects in memory) and a <strong>session</strong>, the next step is to add them to the session:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="8:2"><input checked="checked" id="__tabbed_8_1" name="__tabbed_8" type="radio" /><input id="__tabbed_8_2" name="__tabbed_8" type="radio" /><div class="tabbed-labels"><label for="__tabbed_8_1">Python 3.10+</label><label for="__tabbed_8_2">Python 3.7+</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1"># Code above omitted 👆</span>
<span class="k">def</span> <span class="nf">create_heroes</span><span class="p">():</span>
    <span class="n">hero_1</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Deadpond&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Nx Pkg&quot;</span><span class="p">)</span>
    <span class="n">hero_2</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Spider-Boy&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Pedro Parqueador&quot;</span><span class="p">)</span>
    <span class="n">hero_3</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Rusty-Man&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Tommy Sharp&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">48</span><span class="p">)</span>

    <span class="n">session</span> <span class="o">=</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span>

<span class="hll">    <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_1</span><span class="p">)</span>
</span><span class="hll">    <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_2</span><span class="p">)</span>
</span><span class="hll">    <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_3</span><span class="p">)</span>
</span>
<span class="c1"># More code here later 👇</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1"># Code above omitted 👆</span>
<span class="k">def</span> <span class="nf">create_heroes</span><span class="p">():</span>
    <span class="n">hero_1</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Deadpond&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Nx Pkg&quot;</span><span class="p">)</span>
    <span class="n">hero_2</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Spider-Boy&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Pedro Parqueador&quot;</span><span class="p">)</span>
    <span class="n">hero_3</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Rusty-Man&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Tommy Sharp&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">48</span><span class="p">)</span>

    <span class="n">session</span> <span class="o">=</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span>

<span class="hll">    <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_1</span><span class="p">)</span>
</span><span class="hll">    <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_2</span><span class="p">)</span>
</span><span class="hll">    <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_3</span><span class="p">)</span>
</span>
<span class="c1"># More code here later 👇</span>
</code></pre></div>
</div>
</div>
</div>
<details>
<summary>👀 Full file preview</summary>
<div class="tabbed-set tabbed-alternate" data-tabs="9:2"><input checked="checked" id="__tabbed_9_1" name="__tabbed_9" type="radio" /><input id="__tabbed_9_2" name="__tabbed_9" type="radio" /><div class="tabbed-labels"><label for="__tabbed_9_1">Python 3.10+</label><label for="__tabbed_9_2">Python 3.7+</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">sqldev</span> <span class="kn">import</span> <span class="n">Field</span><span class="p">,</span> <span class="n">Session</span><span class="p">,</span> <span class="n">SQLDev</span><span class="p">,</span> <span class="n">create_engine</span>


<span class="k">class</span> <span class="nc">Hero</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="nb">id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">secret_name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">age</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>


<span class="n">sqlite_file_name</span> <span class="o">=</span> <span class="s2">&quot;database.db&quot;</span>
<span class="n">sqlite_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;sqlite:///</span><span class="si">{</span><span class="n">sqlite_file_name</span><span class="si">}</span><span class="s2">&quot;</span>

<span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="n">sqlite_url</span><span class="p">,</span> <span class="n">echo</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">create_db_and_tables</span><span class="p">():</span>
    <span class="n">SQLDev</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">create_all</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">create_heroes</span><span class="p">():</span>
    <span class="n">hero_1</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Deadpond&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Nx Pkg&quot;</span><span class="p">)</span>
    <span class="n">hero_2</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Spider-Boy&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Pedro Parqueador&quot;</span><span class="p">)</span>
    <span class="n">hero_3</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Rusty-Man&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Tommy Sharp&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">48</span><span class="p">)</span>

    <span class="n">session</span> <span class="o">=</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span>

    <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_1</span><span class="p">)</span>
    <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_2</span><span class="p">)</span>
    <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_3</span><span class="p">)</span>

    <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>

    <span class="n">session</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">create_db_and_tables</span><span class="p">()</span>
    <span class="n">create_heroes</span><span class="p">()</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Optional</span>

<span class="kn">from</span> <span class="nn">sqldev</span> <span class="kn">import</span> <span class="n">Field</span><span class="p">,</span> <span class="n">Session</span><span class="p">,</span> <span class="n">SQLDev</span><span class="p">,</span> <span class="n">create_engine</span>


<span class="k">class</span> <span class="nc">Hero</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="nb">id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">secret_name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">age</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>


<span class="n">sqlite_file_name</span> <span class="o">=</span> <span class="s2">&quot;database.db&quot;</span>
<span class="n">sqlite_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;sqlite:///</span><span class="si">{</span><span class="n">sqlite_file_name</span><span class="si">}</span><span class="s2">&quot;</span>

<span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="n">sqlite_url</span><span class="p">,</span> <span class="n">echo</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">create_db_and_tables</span><span class="p">():</span>
    <span class="n">SQLDev</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">create_all</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">create_heroes</span><span class="p">():</span>
    <span class="n">hero_1</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Deadpond&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Nx Pkg&quot;</span><span class="p">)</span>
    <span class="n">hero_2</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Spider-Boy&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Pedro Parqueador&quot;</span><span class="p">)</span>
    <span class="n">hero_3</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Rusty-Man&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Tommy Sharp&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">48</span><span class="p">)</span>

    <span class="n">session</span> <span class="o">=</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span>

    <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_1</span><span class="p">)</span>
    <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_2</span><span class="p">)</span>
    <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_3</span><span class="p">)</span>

    <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>

    <span class="n">session</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">create_db_and_tables</span><span class="p">()</span>
    <span class="n">create_heroes</span><span class="p">()</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</code></pre></div>
</div>
</div>
</div>
</details>
<p>By this point, our heroes are <em>not</em> stored in the database yet.</p>
<p>And this is one of the cases where having a <strong>session</strong> independent of an <strong>engine</strong> makes sense.</p>
<p>The session is holding in memory all the objects that should be saved in the database later.</p>
<p>And once we are ready, we can <strong>commit</strong> those changes, and then the <strong>session</strong> will use the <strong>engine</strong> underneath to save all the data by sending the appropriate SQL to the database, and that way it will create all the rows. All in a single batch.</p>
<p>This makes the interactions with the database more efficient (plus some extra benefits).</p>
<div class="admonition info">
<p class="admonition-title">Technical Details</p>
<p>The session will create a new transaction and execute all the SQL code in that transaction.</p>
<p>This ensures that the data is saved in a single batch, and that it will all succeed or all fail, but it won't leave the database in a broken state.</p>
</div>
<h2 id="commit-the-session-changes">Commit the Session Changes<a class="headerlink" href="#commit-the-session-changes" title="Permanent link">&para;</a></h2>
<p>Now that we have the heroes in the <strong>session</strong> and that we are ready to save all that to the database, we can <strong>commit</strong> the changes:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="10:2"><input checked="checked" id="__tabbed_10_1" name="__tabbed_10" type="radio" /><input id="__tabbed_10_2" name="__tabbed_10" type="radio" /><div class="tabbed-labels"><label for="__tabbed_10_1">Python 3.10+</label><label for="__tabbed_10_2">Python 3.7+</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1"># Code above omitted 👆</span>
<span class="k">def</span> <span class="nf">create_heroes</span><span class="p">():</span>
    <span class="n">hero_1</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Deadpond&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Nx Pkg&quot;</span><span class="p">)</span>
    <span class="n">hero_2</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Spider-Boy&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Pedro Parqueador&quot;</span><span class="p">)</span>
    <span class="n">hero_3</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Rusty-Man&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Tommy Sharp&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">48</span><span class="p">)</span>

    <span class="n">session</span> <span class="o">=</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span>

    <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_1</span><span class="p">)</span>
    <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_2</span><span class="p">)</span>
    <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_3</span><span class="p">)</span>

<span class="hll">    <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span>
<span class="c1"># More code here later 👇</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1"># Code above omitted 👆</span>
<span class="k">def</span> <span class="nf">create_heroes</span><span class="p">():</span>
    <span class="n">hero_1</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Deadpond&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Nx Pkg&quot;</span><span class="p">)</span>
    <span class="n">hero_2</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Spider-Boy&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Pedro Parqueador&quot;</span><span class="p">)</span>
    <span class="n">hero_3</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Rusty-Man&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Tommy Sharp&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">48</span><span class="p">)</span>

    <span class="n">session</span> <span class="o">=</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span>

    <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_1</span><span class="p">)</span>
    <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_2</span><span class="p">)</span>
    <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_3</span><span class="p">)</span>

<span class="hll">    <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span>
<span class="c1"># More code here later 👇</span>
</code></pre></div>
</div>
</div>
</div>
<details>
<summary>👀 Full file preview</summary>
<div class="tabbed-set tabbed-alternate" data-tabs="11:2"><input checked="checked" id="__tabbed_11_1" name="__tabbed_11" type="radio" /><input id="__tabbed_11_2" name="__tabbed_11" type="radio" /><div class="tabbed-labels"><label for="__tabbed_11_1">Python 3.10+</label><label for="__tabbed_11_2">Python 3.7+</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">sqldev</span> <span class="kn">import</span> <span class="n">Field</span><span class="p">,</span> <span class="n">Session</span><span class="p">,</span> <span class="n">SQLDev</span><span class="p">,</span> <span class="n">create_engine</span>


<span class="k">class</span> <span class="nc">Hero</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="nb">id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">secret_name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">age</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>


<span class="n">sqlite_file_name</span> <span class="o">=</span> <span class="s2">&quot;database.db&quot;</span>
<span class="n">sqlite_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;sqlite:///</span><span class="si">{</span><span class="n">sqlite_file_name</span><span class="si">}</span><span class="s2">&quot;</span>

<span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="n">sqlite_url</span><span class="p">,</span> <span class="n">echo</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">create_db_and_tables</span><span class="p">():</span>
    <span class="n">SQLDev</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">create_all</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">create_heroes</span><span class="p">():</span>
    <span class="n">hero_1</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Deadpond&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Nx Pkg&quot;</span><span class="p">)</span>
    <span class="n">hero_2</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Spider-Boy&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Pedro Parqueador&quot;</span><span class="p">)</span>
    <span class="n">hero_3</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Rusty-Man&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Tommy Sharp&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">48</span><span class="p">)</span>

    <span class="n">session</span> <span class="o">=</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span>

    <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_1</span><span class="p">)</span>
    <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_2</span><span class="p">)</span>
    <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_3</span><span class="p">)</span>

    <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>

    <span class="n">session</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">create_db_and_tables</span><span class="p">()</span>
    <span class="n">create_heroes</span><span class="p">()</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Optional</span>

<span class="kn">from</span> <span class="nn">sqldev</span> <span class="kn">import</span> <span class="n">Field</span><span class="p">,</span> <span class="n">Session</span><span class="p">,</span> <span class="n">SQLDev</span><span class="p">,</span> <span class="n">create_engine</span>


<span class="k">class</span> <span class="nc">Hero</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="nb">id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">secret_name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">age</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>


<span class="n">sqlite_file_name</span> <span class="o">=</span> <span class="s2">&quot;database.db&quot;</span>
<span class="n">sqlite_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;sqlite:///</span><span class="si">{</span><span class="n">sqlite_file_name</span><span class="si">}</span><span class="s2">&quot;</span>

<span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="n">sqlite_url</span><span class="p">,</span> <span class="n">echo</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">create_db_and_tables</span><span class="p">():</span>
    <span class="n">SQLDev</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">create_all</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">create_heroes</span><span class="p">():</span>
    <span class="n">hero_1</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Deadpond&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Nx Pkg&quot;</span><span class="p">)</span>
    <span class="n">hero_2</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Spider-Boy&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Pedro Parqueador&quot;</span><span class="p">)</span>
    <span class="n">hero_3</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Rusty-Man&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Tommy Sharp&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">48</span><span class="p">)</span>

    <span class="n">session</span> <span class="o">=</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span>

    <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_1</span><span class="p">)</span>
    <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_2</span><span class="p">)</span>
    <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_3</span><span class="p">)</span>

    <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>

    <span class="n">session</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">create_db_and_tables</span><span class="p">()</span>
    <span class="n">create_heroes</span><span class="p">()</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</code></pre></div>
</div>
</div>
</div>
</details>
<p>Once this line is executed, the <strong>session</strong> will use the <strong>engine</strong> to save all the data in the database by sending the corresponding SQL.</p>
<h2 id="create-heroes-as-a-script">Create Heroes as a Script<a class="headerlink" href="#create-heroes-as-a-script" title="Permanent link">&para;</a></h2>
<p>The function to create the heroes is now ready.</p>
<p>Now we just need to make sure to call it when we run this program with Python directly.</p>
<p>We already had a main block like:</p>
<div class="highlight"><pre><span></span><code><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">create_db_and_tables</span><span class="p">()</span>
</code></pre></div>
<p>We could add the new function there, as:</p>
<div class="highlight"><pre><span></span><code><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">create_db_and_tables</span><span class="p">()</span>
    <span class="n">create_heroes</span><span class="p">()</span>
</code></pre></div>
<p>But to keep things a bit more organized, let's instead create a new function <code>main()</code> that will contain all the code that should be executed when called as an independent script, and we can put there the previous function <code>create_db_and_tables()</code>, and add the new function <code>create_heroes()</code>:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="12:2"><input checked="checked" id="__tabbed_12_1" name="__tabbed_12" type="radio" /><input id="__tabbed_12_2" name="__tabbed_12" type="radio" /><div class="tabbed-labels"><label for="__tabbed_12_1">Python 3.10+</label><label for="__tabbed_12_2">Python 3.7+</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1"># Code above omitted 👆</span>
<span class="hll"><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
</span>    <span class="n">create_db_and_tables</span><span class="p">()</span>
<span class="hll">    <span class="n">create_heroes</span><span class="p">()</span>
</span>
<span class="c1"># More code here later 👇</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1"># Code above omitted 👆</span>
<span class="hll"><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
</span>    <span class="n">create_db_and_tables</span><span class="p">()</span>
<span class="hll">    <span class="n">create_heroes</span><span class="p">()</span>
</span>
<span class="c1"># More code here later 👇</span>
</code></pre></div>
</div>
</div>
</div>
<details>
<summary>👀 Full file preview</summary>
<div class="tabbed-set tabbed-alternate" data-tabs="13:2"><input checked="checked" id="__tabbed_13_1" name="__tabbed_13" type="radio" /><input id="__tabbed_13_2" name="__tabbed_13" type="radio" /><div class="tabbed-labels"><label for="__tabbed_13_1">Python 3.10+</label><label for="__tabbed_13_2">Python 3.7+</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">sqldev</span> <span class="kn">import</span> <span class="n">Field</span><span class="p">,</span> <span class="n">Session</span><span class="p">,</span> <span class="n">SQLDev</span><span class="p">,</span> <span class="n">create_engine</span>


<span class="k">class</span> <span class="nc">Hero</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="nb">id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">secret_name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">age</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>


<span class="n">sqlite_file_name</span> <span class="o">=</span> <span class="s2">&quot;database.db&quot;</span>
<span class="n">sqlite_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;sqlite:///</span><span class="si">{</span><span class="n">sqlite_file_name</span><span class="si">}</span><span class="s2">&quot;</span>

<span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="n">sqlite_url</span><span class="p">,</span> <span class="n">echo</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">create_db_and_tables</span><span class="p">():</span>
    <span class="n">SQLDev</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">create_all</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">create_heroes</span><span class="p">():</span>
    <span class="n">hero_1</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Deadpond&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Nx Pkg&quot;</span><span class="p">)</span>
    <span class="n">hero_2</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Spider-Boy&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Pedro Parqueador&quot;</span><span class="p">)</span>
    <span class="n">hero_3</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Rusty-Man&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Tommy Sharp&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">48</span><span class="p">)</span>

    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_1</span><span class="p">)</span>
        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_2</span><span class="p">)</span>
        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_3</span><span class="p">)</span>

        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">create_db_and_tables</span><span class="p">()</span>
    <span class="n">create_heroes</span><span class="p">()</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Optional</span>

<span class="kn">from</span> <span class="nn">sqldev</span> <span class="kn">import</span> <span class="n">Field</span><span class="p">,</span> <span class="n">Session</span><span class="p">,</span> <span class="n">SQLDev</span><span class="p">,</span> <span class="n">create_engine</span>


<span class="k">class</span> <span class="nc">Hero</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="nb">id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">secret_name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">age</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>


<span class="n">sqlite_file_name</span> <span class="o">=</span> <span class="s2">&quot;database.db&quot;</span>
<span class="n">sqlite_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;sqlite:///</span><span class="si">{</span><span class="n">sqlite_file_name</span><span class="si">}</span><span class="s2">&quot;</span>

<span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="n">sqlite_url</span><span class="p">,</span> <span class="n">echo</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">create_db_and_tables</span><span class="p">():</span>
    <span class="n">SQLDev</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">create_all</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">create_heroes</span><span class="p">():</span>
    <span class="n">hero_1</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Deadpond&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Nx Pkg&quot;</span><span class="p">)</span>
    <span class="n">hero_2</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Spider-Boy&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Pedro Parqueador&quot;</span><span class="p">)</span>
    <span class="n">hero_3</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Rusty-Man&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Tommy Sharp&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">48</span><span class="p">)</span>

    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_1</span><span class="p">)</span>
        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_2</span><span class="p">)</span>
        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_3</span><span class="p">)</span>

        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">create_db_and_tables</span><span class="p">()</span>
    <span class="n">create_heroes</span><span class="p">()</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</code></pre></div>
</div>
</div>
</div>
</details>
<p>And then we can call that single <code>main()</code> function from that main block:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="14:2"><input checked="checked" id="__tabbed_14_1" name="__tabbed_14" type="radio" /><input id="__tabbed_14_2" name="__tabbed_14" type="radio" /><div class="tabbed-labels"><label for="__tabbed_14_1">Python 3.10+</label><label for="__tabbed_14_2">Python 3.7+</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1"># Code above omitted 👆</span>
<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">create_db_and_tables</span><span class="p">()</span>
    <span class="n">create_heroes</span><span class="p">()</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
<span class="hll">    <span class="n">main</span><span class="p">()</span>
</span></code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1"># Code above omitted 👆</span>
<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">create_db_and_tables</span><span class="p">()</span>
    <span class="n">create_heroes</span><span class="p">()</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
<span class="hll">    <span class="n">main</span><span class="p">()</span>
</span></code></pre></div>
</div>
</div>
</div>
<details>
<summary>👀 Full file preview</summary>
<div class="tabbed-set tabbed-alternate" data-tabs="15:2"><input checked="checked" id="__tabbed_15_1" name="__tabbed_15" type="radio" /><input id="__tabbed_15_2" name="__tabbed_15" type="radio" /><div class="tabbed-labels"><label for="__tabbed_15_1">Python 3.10+</label><label for="__tabbed_15_2">Python 3.7+</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">sqldev</span> <span class="kn">import</span> <span class="n">Field</span><span class="p">,</span> <span class="n">Session</span><span class="p">,</span> <span class="n">SQLDev</span><span class="p">,</span> <span class="n">create_engine</span>


<span class="k">class</span> <span class="nc">Hero</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="nb">id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">secret_name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">age</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>


<span class="n">sqlite_file_name</span> <span class="o">=</span> <span class="s2">&quot;database.db&quot;</span>
<span class="n">sqlite_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;sqlite:///</span><span class="si">{</span><span class="n">sqlite_file_name</span><span class="si">}</span><span class="s2">&quot;</span>

<span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="n">sqlite_url</span><span class="p">,</span> <span class="n">echo</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">create_db_and_tables</span><span class="p">():</span>
    <span class="n">SQLDev</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">create_all</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">create_heroes</span><span class="p">():</span>
    <span class="n">hero_1</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Deadpond&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Nx Pkg&quot;</span><span class="p">)</span>
    <span class="n">hero_2</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Spider-Boy&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Pedro Parqueador&quot;</span><span class="p">)</span>
    <span class="n">hero_3</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Rusty-Man&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Tommy Sharp&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">48</span><span class="p">)</span>

    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_1</span><span class="p">)</span>
        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_2</span><span class="p">)</span>
        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_3</span><span class="p">)</span>

        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">create_db_and_tables</span><span class="p">()</span>
    <span class="n">create_heroes</span><span class="p">()</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Optional</span>

<span class="kn">from</span> <span class="nn">sqldev</span> <span class="kn">import</span> <span class="n">Field</span><span class="p">,</span> <span class="n">Session</span><span class="p">,</span> <span class="n">SQLDev</span><span class="p">,</span> <span class="n">create_engine</span>


<span class="k">class</span> <span class="nc">Hero</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="nb">id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">secret_name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">age</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>


<span class="n">sqlite_file_name</span> <span class="o">=</span> <span class="s2">&quot;database.db&quot;</span>
<span class="n">sqlite_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;sqlite:///</span><span class="si">{</span><span class="n">sqlite_file_name</span><span class="si">}</span><span class="s2">&quot;</span>

<span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="n">sqlite_url</span><span class="p">,</span> <span class="n">echo</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">create_db_and_tables</span><span class="p">():</span>
    <span class="n">SQLDev</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">create_all</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">create_heroes</span><span class="p">():</span>
    <span class="n">hero_1</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Deadpond&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Nx Pkg&quot;</span><span class="p">)</span>
    <span class="n">hero_2</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Spider-Boy&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Pedro Parqueador&quot;</span><span class="p">)</span>
    <span class="n">hero_3</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Rusty-Man&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Tommy Sharp&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">48</span><span class="p">)</span>

    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_1</span><span class="p">)</span>
        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_2</span><span class="p">)</span>
        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_3</span><span class="p">)</span>

        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">create_db_and_tables</span><span class="p">()</span>
    <span class="n">create_heroes</span><span class="p">()</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</code></pre></div>
</div>
</div>
</div>
</details>
<p>By having everything that should happen when called as a script in a single function, we can easily add more code later on.</p>
<p>And some other code could also import and use this same <code>main()</code> function if it was necessary.</p>
<h2 id="run-the-script">Run the Script<a class="headerlink" href="#run-the-script" title="Permanent link">&para;</a></h2>
<p>Now we can run our program as a script from the console.</p>
<p>Because we created the <strong>engine</strong> with <code>echo=True</code>, it will print out all the SQL code that it is executing:</p>
<div class="termy">

<div class="highlight"><pre><span></span><code><span class="gp">$ </span>python<span class="w"> </span>app.py
<span class="go">// Some boilerplate, checking that the hero table already exists</span>
<span class="go">INFO Engine BEGIN (implicit)</span>
<span class="go">INFO Engine PRAGMA main.table_info(&quot;hero&quot;)</span>
<span class="go">INFO Engine [raw sql] ()</span>
<span class="go">INFO Engine COMMIT</span>
<span class="go">// BEGIN a transaction automatically ✨</span>
<span class="go">INFO Engine BEGIN (implicit)</span>
<span class="go">// Our INSERT statement, it uses VALUES (?, ?, ?) as parameters</span>
<span class="go">INFO Engine INSERT INTO hero (name, secret_name, age) VALUES (?, ?, ?)</span>
<span class="go">// ...and these are the parameter values 🚀</span>
<span class="go">INFO Engine [generated in 0.00013s] (&#39;Deadpond&#39;, &#39;Nx Pkg&#39;, None)</span>
<span class="go">// Again, for Spider-Boy</span>
<span class="go">INFO Engine INSERT INTO hero (name, secret_name, age) VALUES (?, ?, ?)</span>
<span class="go">INFO Engine [cached since 0.000755s ago] (&#39;Spider-Boy&#39;, &#39;Pedro Parqueador&#39;, None)</span>
<span class="go">// And now for Rusty-Man</span>
<span class="go">INFO Engine INSERT INTO hero (name, secret_name, age) VALUES (?, ?, ?)</span>
<span class="go">INFO Engine [cached since 0.001014s ago] (&#39;Rusty-Man&#39;, &#39;Tommy Sharp&#39;, 48)</span>
<span class="go">// All good? Yes, commit this transaction! 🎉</span>
<span class="go">INFO Engine COMMIT</span>
</code></pre></div>

</div>

<p>If you have ever used Git, this works very similarly.</p>
<p>We use <code>session.add()</code> to add new objects (model instances) to the session (similar to <code>git add</code>).</p>
<p>And that ends up in a group of data ready to be saved, but not saved yet.</p>
<p>We can make more modifications, add more objects, etc.</p>
<p>And once we are ready, we can <strong>commit</strong> all the changes in a single step (similar to <code>git commit</code>).</p>
<h2 id="close-the-session">Close the Session<a class="headerlink" href="#close-the-session" title="Permanent link">&para;</a></h2>
<p>The <strong>session</strong> holds some resources, like connections from the engine.</p>
<p>So once we are done with the session, we should <strong>close</strong> it to make it release those resources and finish its cleanup:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="16:2"><input checked="checked" id="__tabbed_16_1" name="__tabbed_16" type="radio" /><input id="__tabbed_16_2" name="__tabbed_16" type="radio" /><div class="tabbed-labels"><label for="__tabbed_16_1">Python 3.10+</label><label for="__tabbed_16_2">Python 3.7+</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1"># Code above omitted 👆</span>

<span class="k">def</span> <span class="nf">create_heroes</span><span class="p">():</span>
    <span class="n">hero_1</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Deadpond&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Nx Pkg&quot;</span><span class="p">)</span>
    <span class="n">hero_2</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Spider-Boy&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Pedro Parqueador&quot;</span><span class="p">)</span>
    <span class="n">hero_3</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Rusty-Man&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Tommy Sharp&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">48</span><span class="p">)</span>

    <span class="n">session</span> <span class="o">=</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span>

    <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_1</span><span class="p">)</span>
    <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_2</span><span class="p">)</span>
    <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_3</span><span class="p">)</span>

    <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>

<span class="hll">    <span class="n">session</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span>
<span class="c1"># More code here later 👇</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1"># Code above omitted 👆</span>

<span class="k">def</span> <span class="nf">create_heroes</span><span class="p">():</span>
    <span class="n">hero_1</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Deadpond&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Nx Pkg&quot;</span><span class="p">)</span>
    <span class="n">hero_2</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Spider-Boy&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Pedro Parqueador&quot;</span><span class="p">)</span>
    <span class="n">hero_3</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Rusty-Man&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Tommy Sharp&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">48</span><span class="p">)</span>

    <span class="n">session</span> <span class="o">=</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span>

    <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_1</span><span class="p">)</span>
    <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_2</span><span class="p">)</span>
    <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_3</span><span class="p">)</span>

    <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>

<span class="hll">    <span class="n">session</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span>
<span class="c1"># More code here later 👇</span>
</code></pre></div>
</div>
</div>
</div>
<details>
<summary>👀 Full file preview</summary>
<div class="tabbed-set tabbed-alternate" data-tabs="17:2"><input checked="checked" id="__tabbed_17_1" name="__tabbed_17" type="radio" /><input id="__tabbed_17_2" name="__tabbed_17" type="radio" /><div class="tabbed-labels"><label for="__tabbed_17_1">Python 3.10+</label><label for="__tabbed_17_2">Python 3.7+</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">sqldev</span> <span class="kn">import</span> <span class="n">Field</span><span class="p">,</span> <span class="n">Session</span><span class="p">,</span> <span class="n">SQLDev</span><span class="p">,</span> <span class="n">create_engine</span>


<span class="k">class</span> <span class="nc">Hero</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="nb">id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">secret_name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">age</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>


<span class="n">sqlite_file_name</span> <span class="o">=</span> <span class="s2">&quot;database.db&quot;</span>
<span class="n">sqlite_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;sqlite:///</span><span class="si">{</span><span class="n">sqlite_file_name</span><span class="si">}</span><span class="s2">&quot;</span>

<span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="n">sqlite_url</span><span class="p">,</span> <span class="n">echo</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">create_db_and_tables</span><span class="p">():</span>
    <span class="n">SQLDev</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">create_all</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">create_heroes</span><span class="p">():</span>
    <span class="n">hero_1</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Deadpond&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Nx Pkg&quot;</span><span class="p">)</span>
    <span class="n">hero_2</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Spider-Boy&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Pedro Parqueador&quot;</span><span class="p">)</span>
    <span class="n">hero_3</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Rusty-Man&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Tommy Sharp&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">48</span><span class="p">)</span>

    <span class="n">session</span> <span class="o">=</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span>

    <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_1</span><span class="p">)</span>
    <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_2</span><span class="p">)</span>
    <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_3</span><span class="p">)</span>

    <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>

    <span class="n">session</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">create_db_and_tables</span><span class="p">()</span>
    <span class="n">create_heroes</span><span class="p">()</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Optional</span>

<span class="kn">from</span> <span class="nn">sqldev</span> <span class="kn">import</span> <span class="n">Field</span><span class="p">,</span> <span class="n">Session</span><span class="p">,</span> <span class="n">SQLDev</span><span class="p">,</span> <span class="n">create_engine</span>


<span class="k">class</span> <span class="nc">Hero</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="nb">id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">secret_name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">age</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>


<span class="n">sqlite_file_name</span> <span class="o">=</span> <span class="s2">&quot;database.db&quot;</span>
<span class="n">sqlite_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;sqlite:///</span><span class="si">{</span><span class="n">sqlite_file_name</span><span class="si">}</span><span class="s2">&quot;</span>

<span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="n">sqlite_url</span><span class="p">,</span> <span class="n">echo</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">create_db_and_tables</span><span class="p">():</span>
    <span class="n">SQLDev</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">create_all</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">create_heroes</span><span class="p">():</span>
    <span class="n">hero_1</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Deadpond&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Nx Pkg&quot;</span><span class="p">)</span>
    <span class="n">hero_2</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Spider-Boy&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Pedro Parqueador&quot;</span><span class="p">)</span>
    <span class="n">hero_3</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Rusty-Man&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Tommy Sharp&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">48</span><span class="p">)</span>

    <span class="n">session</span> <span class="o">=</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span>

    <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_1</span><span class="p">)</span>
    <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_2</span><span class="p">)</span>
    <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_3</span><span class="p">)</span>

    <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>

    <span class="n">session</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">create_db_and_tables</span><span class="p">()</span>
    <span class="n">create_heroes</span><span class="p">()</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</code></pre></div>
</div>
</div>
</div>
</details>
<p>But what happens if we forget to close the session?</p>
<p>Or if there's an exception in the code and it never reaches the <code>session.close()</code>?</p>
<p>For that, there's a better way to create and close the session, using a <code>with</code> block. 👇</p>
<h2 id="a-session-in-a-with-block">A Session in a <code>with</code> Block<a class="headerlink" href="#a-session-in-a-with-block" title="Permanent link">&para;</a></h2>
<p>It's good to know how the <code>Session</code> works and how to create and close it manually. It might be useful if, for example, you want to explore the code in an interactive session (for example with Jupyter).</p>
<p>But there's a better way to handle the session, using a <code>with</code> block:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="18:2"><input checked="checked" id="__tabbed_18_1" name="__tabbed_18" type="radio" /><input id="__tabbed_18_2" name="__tabbed_18" type="radio" /><div class="tabbed-labels"><label for="__tabbed_18_1">Python 3.10+</label><label for="__tabbed_18_2">Python 3.7+</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1"># Code above omitted 👆</span>
<span class="k">def</span> <span class="nf">create_heroes</span><span class="p">():</span>
    <span class="n">hero_1</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Deadpond&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Nx Pkg&quot;</span><span class="p">)</span>
    <span class="n">hero_2</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Spider-Boy&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Pedro Parqueador&quot;</span><span class="p">)</span>
    <span class="n">hero_3</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Rusty-Man&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Tommy Sharp&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">48</span><span class="p">)</span>

<span class="hll">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span class="hll">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_1</span><span class="p">)</span>
</span><span class="hll">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_2</span><span class="p">)</span>
</span><span class="hll">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_3</span><span class="p">)</span>
</span><span class="hll">
</span><span class="hll">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span></code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1"># Code above omitted 👆</span>
<span class="k">def</span> <span class="nf">create_heroes</span><span class="p">():</span>
    <span class="n">hero_1</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Deadpond&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Nx Pkg&quot;</span><span class="p">)</span>
    <span class="n">hero_2</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Spider-Boy&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Pedro Parqueador&quot;</span><span class="p">)</span>
    <span class="n">hero_3</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Rusty-Man&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Tommy Sharp&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">48</span><span class="p">)</span>

<span class="hll">    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span><span class="hll">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_1</span><span class="p">)</span>
</span><span class="hll">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_2</span><span class="p">)</span>
</span><span class="hll">        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_3</span><span class="p">)</span>
</span><span class="hll">
</span><span class="hll">        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span></code></pre></div>
</div>
</div>
</div>
<details>
<summary>👀 Full file preview</summary>
<div class="tabbed-set tabbed-alternate" data-tabs="19:2"><input checked="checked" id="__tabbed_19_1" name="__tabbed_19" type="radio" /><input id="__tabbed_19_2" name="__tabbed_19" type="radio" /><div class="tabbed-labels"><label for="__tabbed_19_1">Python 3.10+</label><label for="__tabbed_19_2">Python 3.7+</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">sqldev</span> <span class="kn">import</span> <span class="n">Field</span><span class="p">,</span> <span class="n">Session</span><span class="p">,</span> <span class="n">SQLDev</span><span class="p">,</span> <span class="n">create_engine</span>


<span class="k">class</span> <span class="nc">Hero</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="nb">id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">secret_name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">age</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>


<span class="n">sqlite_file_name</span> <span class="o">=</span> <span class="s2">&quot;database.db&quot;</span>
<span class="n">sqlite_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;sqlite:///</span><span class="si">{</span><span class="n">sqlite_file_name</span><span class="si">}</span><span class="s2">&quot;</span>

<span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="n">sqlite_url</span><span class="p">,</span> <span class="n">echo</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">create_db_and_tables</span><span class="p">():</span>
    <span class="n">SQLDev</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">create_all</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">create_heroes</span><span class="p">():</span>
    <span class="n">hero_1</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Deadpond&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Nx Pkg&quot;</span><span class="p">)</span>
    <span class="n">hero_2</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Spider-Boy&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Pedro Parqueador&quot;</span><span class="p">)</span>
    <span class="n">hero_3</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Rusty-Man&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Tommy Sharp&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">48</span><span class="p">)</span>

    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_1</span><span class="p">)</span>
        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_2</span><span class="p">)</span>
        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_3</span><span class="p">)</span>

        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">create_db_and_tables</span><span class="p">()</span>
    <span class="n">create_heroes</span><span class="p">()</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Optional</span>

<span class="kn">from</span> <span class="nn">sqldev</span> <span class="kn">import</span> <span class="n">Field</span><span class="p">,</span> <span class="n">Session</span><span class="p">,</span> <span class="n">SQLDev</span><span class="p">,</span> <span class="n">create_engine</span>


<span class="k">class</span> <span class="nc">Hero</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="nb">id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">secret_name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">age</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>


<span class="n">sqlite_file_name</span> <span class="o">=</span> <span class="s2">&quot;database.db&quot;</span>
<span class="n">sqlite_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;sqlite:///</span><span class="si">{</span><span class="n">sqlite_file_name</span><span class="si">}</span><span class="s2">&quot;</span>

<span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="n">sqlite_url</span><span class="p">,</span> <span class="n">echo</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">create_db_and_tables</span><span class="p">():</span>
    <span class="n">SQLDev</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">create_all</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">create_heroes</span><span class="p">():</span>
    <span class="n">hero_1</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Deadpond&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Nx Pkg&quot;</span><span class="p">)</span>
    <span class="n">hero_2</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Spider-Boy&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Pedro Parqueador&quot;</span><span class="p">)</span>
    <span class="n">hero_3</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Rusty-Man&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Tommy Sharp&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">48</span><span class="p">)</span>

    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_1</span><span class="p">)</span>
        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_2</span><span class="p">)</span>
        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_3</span><span class="p">)</span>

        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">create_db_and_tables</span><span class="p">()</span>
    <span class="n">create_heroes</span><span class="p">()</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</code></pre></div>
</div>
</div>
</div>
</details>
<p>This is the same as creating the session manually and then manually closing it. But here, using a <code>with</code> block, it will be automatically created when <strong>starting</strong> the <code>with</code> block and assigned to the variable <code>session</code>, and it will be automatically closed after the <code>with</code> block is <strong>finished</strong>.</p>
<p>And it will work even if there's an exception in the code. 😎</p>
<h2 id="review-all-the-code">Review All the Code<a class="headerlink" href="#review-all-the-code" title="Permanent link">&para;</a></h2>
<p>Let's give this whole file a final look. 🔍</p>
<p>You already know all the first part creating the <code>Hero</code> model class, the <strong>engine</strong>, and creating the database and table.</p>
<p>Let's focus on the new code:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="20:2"><input checked="checked" id="__tabbed_20_1" name="__tabbed_20" type="radio" /><input id="__tabbed_20_2" name="__tabbed_20" type="radio" /><div class="tabbed-labels"><label for="__tabbed_20_1">Python 3.10+</label><label for="__tabbed_20_2">Python 3.7+</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="annotate highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">sqldev</span> <span class="kn">import</span> <span class="n">Field</span><span class="p">,</span> <span class="n">Session</span><span class="p">,</span> <span class="n">SQLDev</span><span class="p">,</span> <span class="n">create_engine</span>


<span class="k">class</span> <span class="nc">Hero</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="nb">id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">secret_name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">age</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>


<span class="n">sqlite_file_name</span> <span class="o">=</span> <span class="s2">&quot;database.db&quot;</span>
<span class="n">sqlite_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;sqlite:///</span><span class="si">{</span><span class="n">sqlite_file_name</span><span class="si">}</span><span class="s2">&quot;</span>

<span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="n">sqlite_url</span><span class="p">,</span> <span class="n">echo</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">create_db_and_tables</span><span class="p">():</span>
    <span class="n">SQLDev</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">create_all</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">create_heroes</span><span class="p">():</span>  <span class="c1"># (1)!</span>
    <span class="n">hero_1</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Deadpond&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Nx Pkg&quot;</span><span class="p">)</span>  <span class="c1"># (2)!</span>
    <span class="n">hero_2</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Spider-Boy&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Pedro Parqueador&quot;</span><span class="p">)</span>
    <span class="n">hero_3</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Rusty-Man&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Tommy Sharp&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">48</span><span class="p">)</span>

    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>  <span class="c1"># (3)!</span>
        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_1</span><span class="p">)</span>  <span class="c1"># (4)!</span>
        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_2</span><span class="p">)</span>
        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_3</span><span class="p">)</span>

        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>  <span class="c1"># (5)!</span>
    <span class="c1"># (6)!</span>


<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>  <span class="c1"># (7)!</span>
    <span class="n">create_db_and_tables</span><span class="p">()</span>  <span class="c1"># (8)!</span>
    <span class="n">create_heroes</span><span class="p">()</span>  <span class="c1"># (9)!</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>  <span class="c1"># (10)!</span>
    <span class="n">main</span><span class="p">()</span>  <span class="c1"># (11)!</span>
</code></pre></div>
<ol>
<li>
<p>We use a function <code>create_heroes()</code> to put this logic together.</p>
</li>
<li>
<p>Create each of the objects/instances of the <code>Hero</code> model.</p>
<p>Each of them represents the data for one row.</p>
</li>
<li>
<p>Use a <code>with</code> block to create a <code>Session</code> using the <code>engine</code>.</p>
<p>The new <strong>sesion</strong> will be assigned to the variable <code>session</code>.</p>
<p>And it will be automatically closed when the <code>with</code> block is finished.</p>
</li>
<li>
<p>Add each of the objects/instances to the <strong>session</strong>.</p>
<p>Each of these objects represents a row in the database.</p>
<p>They are all waiting there in the session to be saved.</p>
</li>
<li>
<p><strong>Commit</strong> the changes to the database.</p>
<p>This will actually send the data to the database.</p>
<p>It will start a transaction automatically and save all the data in a single batch.</p>
</li>
<li>
<p>By this point, after the <code>with</code> block is finished, the <strong>session</strong> is automatically closed.</p>
</li>
<li>
<p>We have a <code>main()</code> function with all the code that should be executed when the program is called as a <strong>script from the console</strong>.</p>
<p>That way we can add more code later to this function.</p>
<p>We then put this function <code>main()</code> in the main block below.</p>
<p>And as it is a single function, other Python files could <strong>import it</strong> and call it directly.</p>
</li>
<li>
<p>In this <code>main()</code> function, we are also creating the database and the tables.</p>
<p>In the previous version, this function was called directly in the main block.</p>
<p>But now it is just called in the <code>main()</code> function.</p>
</li>
<li>
<p>And now we are also creating the heroes in this <code>main()</code> function.</p>
</li>
<li>
<p>We still have a main block to execute some code when the program is run as a script from the command line, like:</p>
<div class="termy">
<div class="highlight"><pre><span></span><code><span class="gp">$ </span>python<span class="w"> </span>app.py

<span class="go">// Do whatever is in the main block 🚀</span>
</code></pre></div>
</div>
</li>
<li>
<p>There's a single <code>main()</code> function now that contains all the code that should be executed when running the program from the console.</p>
<p>So this is all we need to have in the main block. Just call the <code>main()</code> function.</p>
</li>
</ol>
</div>
<div class="tabbed-block">
<div class="annotate highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Optional</span>

<span class="kn">from</span> <span class="nn">sqldev</span> <span class="kn">import</span> <span class="n">Field</span><span class="p">,</span> <span class="n">Session</span><span class="p">,</span> <span class="n">SQLDev</span><span class="p">,</span> <span class="n">create_engine</span>


<span class="k">class</span> <span class="nc">Hero</span><span class="p">(</span><span class="n">SQLDev</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="nb">id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">secret_name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">age</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>


<span class="n">sqlite_file_name</span> <span class="o">=</span> <span class="s2">&quot;database.db&quot;</span>
<span class="n">sqlite_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;sqlite:///</span><span class="si">{</span><span class="n">sqlite_file_name</span><span class="si">}</span><span class="s2">&quot;</span>

<span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="n">sqlite_url</span><span class="p">,</span> <span class="n">echo</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">create_db_and_tables</span><span class="p">():</span>
    <span class="n">SQLDev</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">create_all</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">create_heroes</span><span class="p">():</span>  <span class="c1"># (1)!</span>
    <span class="n">hero_1</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Deadpond&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Nx Pkg&quot;</span><span class="p">)</span>  <span class="c1"># (2)!</span>
    <span class="n">hero_2</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Spider-Boy&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Pedro Parqueador&quot;</span><span class="p">)</span>
    <span class="n">hero_3</span> <span class="o">=</span> <span class="n">Hero</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Rusty-Man&quot;</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="s2">&quot;Tommy Sharp&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">48</span><span class="p">)</span>

    <span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>  <span class="c1"># (3)!</span>
        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_1</span><span class="p">)</span>  <span class="c1"># (4)!</span>
        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_2</span><span class="p">)</span>
        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">hero_3</span><span class="p">)</span>

        <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>  <span class="c1"># (5)!</span>
    <span class="c1"># (6)!</span>


<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>  <span class="c1"># (7)!</span>
    <span class="n">create_db_and_tables</span><span class="p">()</span>  <span class="c1"># (8)!</span>
    <span class="n">create_heroes</span><span class="p">()</span>  <span class="c1"># (9)!</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>  <span class="c1"># (10)!</span>
    <span class="n">main</span><span class="p">()</span>  <span class="c1"># (11)!</span>
</code></pre></div>
<ol>
<li>
<p>We use a function <code>create_heroes()</code> to put this logic together.</p>
</li>
<li>
<p>Create each of the objects/instances of the <code>Hero</code> model.</p>
<p>Each of them represents the data for one row.</p>
</li>
<li>
<p>Use a <code>with</code> block to create a <code>Session</code> using the <code>engine</code>.</p>
<p>The new <strong>sesion</strong> will be assigned to the variable <code>session</code>.</p>
<p>And it will be automatically closed when the <code>with</code> block is finished.</p>
</li>
<li>
<p>Add each of the objects/instances to the <strong>session</strong>.</p>
<p>Each of these objects represents a row in the database.</p>
<p>They are all waiting there in the session to be saved.</p>
</li>
<li>
<p><strong>Commit</strong> the changes to the database.</p>
<p>This will actually send the data to the database.</p>
<p>It will start a transaction automatically and save all the data in a single batch.</p>
</li>
<li>
<p>By this point, after the <code>with</code> block is finished, the <strong>session</strong> is automatically closed.</p>
</li>
<li>
<p>We have a <code>main()</code> function with all the code that should be executed when the program is called as a <strong>script from the console</strong>.</p>
<p>That way we can add more code later to this function.</p>
<p>We then put this function <code>main()</code> in the main block below.</p>
<p>And as it is a single function, other Python files could <strong>import it</strong> and call it directly.</p>
</li>
<li>
<p>In this <code>main()</code> function, we are also creating the database and the tables.</p>
<p>In the previous version, this function was called directly in the main block.</p>
<p>But now it is just called in the <code>main()</code> function.</p>
</li>
<li>
<p>And now we are also creating the heroes in this <code>main()</code> function.</p>
</li>
<li>
<p>We still have a main block to execute some code when the program is run as a script from the command line, like:</p>
<div class="termy">
<div class="highlight"><pre><span></span><code><span class="gp">$ </span>python<span class="w"> </span>app.py

<span class="go">// Do whatever is in the main block 🚀</span>
</code></pre></div>
</div>
</li>
<li>
<p>There's a single <code>main()</code> function now that contains all the code that should be executed when running the program from the console.</p>
<p>So this is all we need to have in the main block. Just call the <code>main()</code> function.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Review what each line does by clicking each number bubble in the code. 👆</p>
</div>
<p>You can now put it in a <code>app.py</code> file and run it with Python. And you will see an output like the one shown above.</p>
<p>After that, if you open the database with <strong>DB Browser for SQLite</strong>, you will see the data you just created in the <kbd>Browse Data</kbd> tab:</p>
<p><img class="shadow" src="/img/tutorial/insert/image03.png"></p>
<h2 id="whats-next">What's Next<a class="headerlink" href="#whats-next" title="Permanent link">&para;</a></h2>
<p>Now you know how to add rows to the database. 🎉</p>
<p>Now is a good time to understand better why the <code>id</code> field <strong>can't be <code>NULL</code></strong> on the database because it's a <strong>primary key</strong>, but actually <strong>can be <code>None</code></strong> in the Python code.</p>
<p>I'll tell you about that in the next chapter. 🚀</p>









  




                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var tab,labels=set.querySelector(".tabbed-labels");for(tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/khulnasoft/sqldev" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 480 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://twitter.com/khulnasoft" target="_blank" rel="noopener" title="twitter.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.linkedin.com/in/khulnasoft" target="_blank" rel="noopener" title="www.linkedin.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://dev.to/khulnasoft" target="_blank" rel="noopener" title="dev.to" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M120.12 208.29c-3.88-2.9-7.77-4.35-11.65-4.35H91.03v104.47h17.45c3.88 0 7.77-1.45 11.65-4.35 3.88-2.9 5.82-7.25 5.82-13.06v-69.65c-.01-5.8-1.96-10.16-5.83-13.06zM404.1 32H43.9C19.7 32 .06 51.59 0 75.8v360.4C.06 460.41 19.7 480 43.9 480h360.2c24.21 0 43.84-19.59 43.9-43.8V75.8c-.06-24.21-19.7-43.8-43.9-43.8zM154.2 291.19c0 18.81-11.61 47.31-48.36 47.25h-46.4V172.98h47.38c35.44 0 47.36 28.46 47.37 47.28l.01 70.93zm100.68-88.66H201.6v38.42h32.57v29.57H201.6v38.41h53.29v29.57h-62.18c-11.16.29-20.44-8.53-20.72-19.69V193.7c-.27-11.15 8.56-20.41 19.71-20.69h63.19l-.01 29.52zm103.64 115.29c-13.2 30.75-36.85 24.63-47.44 0l-38.53-144.8h32.57l29.71 113.72 29.57-113.72h32.58l-38.46 144.8z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://medium.com/@khulnasoft" target="_blank" rel="noopener" title="medium.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M180.5 74.262C80.813 74.262 0 155.633 0 256s80.819 181.738 180.5 181.738S361 356.373 361 256 280.191 74.262 180.5 74.262Zm288.25 10.646c-49.845 0-90.245 76.619-90.245 171.095s40.406 171.1 90.251 171.1 90.251-76.619 90.251-171.1H559c0-94.503-40.4-171.095-90.248-171.095Zm139.506 17.821c-17.526 0-31.735 68.628-31.735 153.274s14.2 153.274 31.735 153.274S640 340.631 640 256c0-84.649-14.215-153.271-31.742-153.271Z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://khulnasoft.com" target="_blank" rel="noopener" title="khulnasoft.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M352 256c0 22.2-1.2 43.6-3.3 64H163.3c-2.2-20.4-3.3-41.8-3.3-64s1.2-43.6 3.3-64h185.4c2.2 20.4 3.3 41.8 3.3 64zm28.8-64h123.1c5.3 20.5 8.1 41.9 8.1 64s-2.8 43.5-8.1 64H380.8c2.1-20.6 3.2-42 3.2-64s-1.1-43.4-3.2-64zm112.6-32H376.7c-10-63.9-29.8-117.4-55.3-151.6 78.3 20.7 142 77.5 171.9 151.6zm-149.1 0H167.7c6.1-36.4 15.5-68.6 27-94.7 10.5-23.6 22.2-40.7 33.5-51.5C239.4 3.2 248.7 0 256 0s16.6 3.2 27.8 13.8c11.3 10.8 23 27.9 33.5 51.5 11.6 26 20.9 58.2 27 94.7zm-209 0H18.6c30-74.1 93.6-130.9 172-151.6-25.5 34.2-45.3 87.7-55.3 151.6zM8.1 192h123.1c-2.1 20.6-3.2 42-3.2 64s1.1 43.4 3.2 64H8.1C2.8 299.5 0 278.1 0 256s2.8-43.5 8.1-64zm186.6 254.6c-11.6-26-20.9-58.2-27-94.6h176.6c-6.1 36.4-15.5 68.6-27 94.6-10.5 23.6-22.2 40.7-33.5 51.5-11.2 10.7-20.5 13.9-27.8 13.9s-16.6-3.2-27.8-13.8c-11.3-10.8-23-27.9-33.5-51.5zM135.3 352c10 63.9 29.8 117.4 55.3 151.6-78.4-20.7-142-77.5-172-151.6h116.7zm358.1 0c-30 74.1-93.6 130.9-171.9 151.6 25.5-34.2 45.2-87.7 55.3-151.6h116.6z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["search.suggest", "search.highlight", "content.tabs.link", "navigation.indexes", "content.tooltips", "navigation.path", "content.code.annotate", "content.code.copy", "content.code.select"], "search": "../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.ad660dcc.min.js"></script>
      
        <script src="../../js/termynal.js"></script>
      
        <script src="../../js/custom.js"></script>
      
    
  </body>
</html>